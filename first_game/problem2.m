clc
clear

% 原始数据矩阵，注意每列是一个指标，每行是一个样本
X = [
46735	32.8	101.7	274079	22.7	32.17	243.86	7462.26	31.48	60.75	183583	2.2	85.5	41.6	93.2
50941	32.8	102.7	378136	22.4	33.98	242.41	7559.02	33.32	62.63	156534	2.41	84.7	41.8	94.2
55400	32.1	102.3	411985	22.6	33.07	248.9	7819.31	34.31	62.23	128815	2.4	80.5	42.54	95
59982	32.1	102.4	471352	22.6	34.22	266.01	14007.14	36.32	63.83	111857	1.9	80.5	45.13	95.5
65052	32	103	526666	23.1	34.37	288.22	14083.44	38.33	65.39	105997	2.15	80.3	45.5	97
68304	32.4	102.6	493317	23.1	34.61	308.18	14162.84	33.26	54.24	100807	2.53	90.4	45.52	97.9
74416	31.7	101.1	468599	24	34.28	330.86	14871.09	35.2	56.62	99630	2.22	88.5	43.6	98.3

];

% 手标指标权重
weights_self = [0.4, 0.3, 0.3, 0.4, 0.3, 0.3, 0.4, 0.3, 0.3, 0.4, 0.3, 0.3, 0.4, 0.3, 0.3];

% 指标类型（1：极大型，2：极小型，3：区间型）
types = [1, 2, 1, 1, 1, 1, 3, 1, 1, 1,1 ,1 ,1 ,1 ,1];

% 熵权法标权重
weights_ent = entropy_weight(X, types, 1, 2);

disp('熵权法测的权重');
disp(weights_ent);

weights = 0.7*weights_ent + 0.3*weights_self;
disp('打分所得的权重');
disp(weights);

S = topsis(X, weights, types);

% 显示结果
disp('相对接近度得分(这项指标（宜居，智慧）得分)：');
disp(S);

